(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{433:function(e,t,n){"use strict";t.a=[{name:"Tier 1-1",success:70,hploss:200,exp:100,reward:.003135},{name:"Tier 1-2",success:67,hploss:200,exp:110,reward:.003762},{name:"Tier 1-3",success:63,hploss:200,exp:120,reward:.004389},{name:"Tier 2-1",success:59,hploss:200,exp:130,reward:.005016},{name:"Tier 2-2",success:55,hploss:200,exp:150,reward:.005643},{name:"Tier 2-3",success:51,hploss:200,exp:200,reward:.00627},{name:"Boss 1",success:28,hploss:400,exp:400,reward:.02299}]},438:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return y})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return k}));var a=n(465),i=n.n(a),r=n(433),s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,u=e[Symbol.iterator]();!(a=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=function(e){return i.a.encode(e)},p=function(e){return i.a.decode(e)},o=function(e){try{return JSON.parse(e)}catch(e){return""}},l=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];localStorage[u(e)]=u(n?JSON.stringify(t):t)},y=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=localStorage[u(e)];if(n)try{var a=p(n);return t?o(a):a}catch(e){return""}return""},c=function(){for(var e=[],t=0,n=1;n<102;n++){var a=~~((n-2)/10),i=1e3;1===a?i=2e3:a>1&&(i=1e3+500*(a+1)),t+=i,e.push(t)}return e}(),d=function(e){return 2==+e?30:3==+e?60:4==+e?140:0},m=function(e){return 2==+e?3:3==+e?6:4==+e?16:0},f=function(e){return 2==+e?-5:3==+e?-13:4==+e?-28:0},h=function(e){return 2==+e?30:3==+e?60:4==+e?90:0},T=function(e){var t=c.findIndex((function(t){return e<t}));return-1===t?101:t},b=function(e,t,n){var a=e*(100+t)/100;return a+n*a/1500},v=function(e,t){return Math.ceil(e-t/20)},g=function(e){var t=e.card,n=e.build,a=(e.gas,s(t,4)),i=a[0],r=a[1],u=a[2],p=a[3],o=s(n,4),l=o[0],y=o[1],c=o[2],T=o[3],b=d(l),v=m(y),g=f(c),w=86.4*(100+g)/100;return{buildData:{attr:b,reward:v,exp:h(T),dishp:g},cardData:{vatk:10*(i-1)+r+b,vdef:10*(i-1)+u+b,vagi:10*(i-1)+p+b,hpcd:w,everyDayHp:(86400/w).strip(4)}}},w=function(e){var t=e.card,n=e.build,a=(e.gas,s(t,4)),i=a[0],r=a[1],u=a[2],p=a[3],o=T(i),l=s(n,4),y=l[0],c=l[1],b=l[2],v=l[3],g=d(y),w=m(c),x=f(b),k=86.4*(100+x)/100;return{buildData:{attr:g,reward:w,exp:h(v),dishp:x},cardData:{initExp:i,initLv:o,vatk:10*(o-1)+r+g,vdef:10*(o-1)+u+g,vagi:10*(o-1)+p+g,hpcd:k,everyDayHp:(86400/k).strip(4)}}},x=function(e){var t=e.cardData,n=e.buildData,a=e.gas,i=t.vatk,s=t.vdef,u=t.vagi,p=t.everyDayHp,o=n.reward,l=n.exp;return r.a.map((function(e){var t=e.name,n=e.success,r=e.hploss,y=e.exp,c=e.reward,d=n+i/100,m=b(c,o,u),f=v(r,s),h=p/(((100-d)*r+d*f)/100),T=d/100*(y+l),g=Math.ceil(h*T),w=(h*(d/100*m-a)).strip(4);return{name:t,successC:d,rewardC:m.strip(8),hplossC:f,everyXp:g,everyRewrad:w}}))},k=function(e){e.card;var t=e.cardData,n=e.buildData,a=e.gas,i=e.totalHp,s=e.enemyType,u=t.initLv,p=t.initExp,o=t.vatk,l=t.vdef,y=t.vagi,c=n.reward,d=n.exp,m=r.a[s],f=(m.name,m.success),h=m.hploss,g=m.exp,w=m.reward,x=[],k=u,D=+i,M=p,C=0,_=o,I=l,E=y,$=0,H=0,F=0,A=0;return function e(){if(C++,D<h)return{arr:x,maxSuccess:$,maxFair:F};var t=10*(f+o/100),n=b(w,c,E),i=d+g,r=v(h,I),s=Math.floor((1e3*Math.random()+1)%1e3)<t;if(s){A=0,$<++H&&($=H),D-=r;var u="#"+C+" Lv"+k+"("+(M+=i)+") 戰鬥成功 獎勵: "+n.strip(8)+" 獲得經驗: "+i+" HP損失: "+r;x.unshift({type:"Fight",isSuccess:s,hploss:r,rewards:n,exp:i,gas:a,lv:k,log:u,atk:_,def:I,agi:E,count:C,totalExp:M});var p=T(M);if(p>k){var l="#"+ ++C+" 升級 "+p;_+=10,I+=10,E+=10,k=p,x.unshift({type:"level up",gas:a,lv:k,atk:_,def:I,agi:E,log:l,count:C,rewards:"",exp:"",hploss:"",totalExp:M})}return e()}H=0,F<++A&&(F=A),D-=h;var y="#"+C+" 戰鬥失敗 Lv"+k+" HP損失: "+h;return x.unshift({type:"Fight",isSuccess:s,hploss:h,rewards:0,exp:0,gas:a,lv:k,atk:_,def:I,agi:E,log:y,count:C,totalExp:M}),e()}()}},529:function(e,t,n){},618:function(e,t,n){},648:function(e,t,n){"use strict";n(529)},662:function(e,t){},664:function(e,t){},666:function(e,t){},670:function(e,t){},694:function(e,t){},696:function(e,t){},705:function(e,t){},707:function(e,t){},717:function(e,t){},719:function(e,t){},828:function(e,t){},830:function(e,t){},837:function(e,t){},838:function(e,t){},928:function(e,t,n){"use strict";n(618)},935:function(e,t,n){"use strict";n.r(t);var a=n(438),i=n(520),r=n.n(i),s=n(484),u=n.n(s),p={name:"item-component",data:function(){return{columns:[{title:"英雄 Hero",key:"_heroId"},{title:"敵人 Enemies",key:"enemyType"},{title:"獎勵 Rewards",key:"rewards"},{title:"經驗值 EXP",key:"xpGained"},{title:"損血 Hploss",key:"hpLoss"},{title:"燃料費 Gas",key:"gasValue"},{title:"時間 Date",key:"date"}],rowClassName:this.source.rewards?"":this.source.hpLoss?"fair":"others"}},props:{index:{type:Number},source:{type:Object,default:function(){return{}}}},methods:{handleRowClick:function(){this.$parent.$parent.$parent.filterHero=this.source._heroId,this.$parent.$parent.$parent.filterEnemyType=this.source.enemyType}}},o=(n(648),n(2)),l=Object(o.a)(p,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex",class:e.rowClassName},e._l(e.columns,(function(t){return n("div",{key:t.key+e.source.date,on:{click:e.handleRowClick}},[e._v(e._s(e.source[t.key]))])})),0)}),[],!1,null,"70387bbe",null).exports,y=n(433),c=n(649),d=n.n(c),m=n(650),f=new(n.n(m).a)(window.ethereum),h=[{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"CancelledListing",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbPrice",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbhPrice",type:"uint256"}],name:"ListingPriceChange",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbPrice",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbhPrice",type:"uint256"}],name:"NewListing",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"buyer",type:"address"},{indexed:!1,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbPrice",type:"uint256"},{indexed:!1,internalType:"uint256",name:"bnbhPrice",type:"uint256"},{indexed:!1,internalType:"uint256",name:"tax",type:"uint256"}],name:"PurchaseListing",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"bannedList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"bnbhToken",outputs:[{internalType:"contract IBEP20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"characters",outputs:[{internalType:"contract IBNBHCharacter",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"excludeFromTax",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"lastTransferredTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maintenanceMode",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"minimumPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"priceOracle",outputs:[{internalType:"contract IPriceOracle",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"taxFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"taxFeeRecepient",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IBEP20",name:"_bnbhToken",type:"address"},{internalType:"contract IBNBHCharacter",name:"_characters",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"migrateExcludeFromTax",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"removeBannedHeores",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"setTokenAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"character",type:"address"}],name:"setCharacterAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"mode",type:"bool"}],name:"setmaintenanceMode",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"fee",type:"uint256"}],name:"setTaxFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"setTaxFeeRecepient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"oracle",type:"address"}],name:"setPriceOracle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"setMinimumPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bool",name:"state",type:"bool"}],name:"setBannedAccount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_limit",type:"uint256"},{internalType:"uint256",name:"_pageNumber",type:"uint256"}],name:"getCharacterListingIDsPage",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_limit",type:"uint256"},{internalType:"uint256",name:"_pageNumber",type:"uint256"}],name:"getCharactersForPage",outputs:[{components:[{internalType:"uint256",name:"name",type:"uint256"},{internalType:"uint256",name:"heroType",type:"uint256"},{internalType:"uint256",name:"xp",type:"uint256"},{internalType:"uint256",name:"attack",type:"uint256"},{internalType:"uint256",name:"armor",type:"uint256"},{internalType:"uint256",name:"speed",type:"uint256"},{internalType:"uint256",name:"hp",type:"uint256"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"heroClass",type:"uint256"}],internalType:"struct BNBHMarket.MarketHero[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllTokenIds",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"seller",type:"address"}],name:"getCharactersForSeller",outputs:[{components:[{internalType:"uint256",name:"name",type:"uint256"},{internalType:"uint256",name:"heroType",type:"uint256"},{internalType:"uint256",name:"xp",type:"uint256"},{internalType:"uint256",name:"attack",type:"uint256"},{internalType:"uint256",name:"armor",type:"uint256"},{internalType:"uint256",name:"speed",type:"uint256"},{internalType:"uint256",name:"hp",type:"uint256"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"heroClass",type:"uint256"}],internalType:"struct BNBHMarket.MarketHero[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_heroId",type:"uint256"}],name:"getCharacterDataById",outputs:[{components:[{internalType:"uint256",name:"name",type:"uint256"},{internalType:"uint256",name:"heroType",type:"uint256"},{internalType:"uint256",name:"xp",type:"uint256"},{internalType:"uint256",name:"attack",type:"uint256"},{internalType:"uint256",name:"armor",type:"uint256"},{internalType:"uint256",name:"speed",type:"uint256"},{internalType:"uint256",name:"hp",type:"uint256"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"heroClass",type:"uint256"}],internalType:"struct BNBHMarket.MarketHero",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"getCharacterDataByIds",outputs:[{components:[{internalType:"uint256",name:"name",type:"uint256"},{internalType:"uint256",name:"heroType",type:"uint256"},{internalType:"uint256",name:"xp",type:"uint256"},{internalType:"uint256",name:"attack",type:"uint256"},{internalType:"uint256",name:"armor",type:"uint256"},{internalType:"uint256",name:"speed",type:"uint256"},{internalType:"uint256",name:"hp",type:"uint256"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"heroClass",type:"uint256"}],internalType:"struct BNBHMarket.MarketHero[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"getSellerOfNftID",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_seller",type:"address"}],name:"getNumberOfListingsBySeller",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_seller",type:"address"}],name:"getListingIDsBySeller",outputs:[{internalType:"uint256[]",name:"tokens",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNumberOfCharacterListings",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_heroId",type:"uint256"}],name:"canListOrChangePrice",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"addListing",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"uint256",name:"_newPrice",type:"uint256"}],name:"changeListingPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"cancelListing",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"purchaseListing",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"view",type:"function"}],T=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,u=e[Symbol.iterator]();!(a=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function b(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function a(i,r){try{var s=t[i](r),u=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(u).then((function(e){a("next",e)}),(function(e){a("throw",e)}));e(u)}("next")}))}}var v={name:"FightData",components:{VirtualList:u.a},data:function(){return{item:l,api:"https://graphql.bitquery.io",walletAddress:Object(a.g)("walletAddress")||"",dataAddress:"0xde9fFb228C1789FEf3F08014498F2b16c57db855",contract:"0x5CFFca0321b83dc873Bd2439aE7fEA10aE163fac",contractData:void 0,filterHero:"",filterEnemyType:"",network:"bsc",eventType:"Fight",startDate:null,endDate:null,data:[],columns:[{title:"英雄 Hero",key:"_heroId"},{title:"敵人 Enemies",key:"enemyType"},{title:"獎勵 Rewards",key:"rewards"},{title:"經驗值 EXP",key:"xpGained"},{title:"損血 Hploss",key:"hpLoss"},{title:"燃料費 Gas",key:"gasValue"},{title:"時間 Date",key:"date"}],typeObj:{1:"普通 Common",2:"罕見 Uncommon",3:"稀有 Rare",4:"史詩 Epic",5:"傳說 Legendary"},classObj:{1:"士兵 Soldier",2:"獵人 Hunter",3:"刺客 Rogue",4:"法師 Mage",5:"騎士 Knight"},heroObj:{},successTrs:[],fairTrs:[],isLoading:!1}},beforeMount:function(){var e=this;return b(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new f.eth.Contract(h,e.contract);case 2:e.contractData=t.sent,e.walletAddress&&e.handleCalc();case 4:case"end":return t.stop()}}),t,e)})))()},methods:{handleCalc:function(){var e=this;return b(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.fetchGetFightData();case 3:e.isLoading=!1;case 4:case"end":return t.stop()}}),t,e)})))()},fetchGetCount:function(){var e=this;return r()({method:"post",url:this.api,headers:{"X-API-KEY":"BQYvhnv04csZHaprIBZNwtpRiDIwEIW9"},data:{query:"query ($network: EthereumNetwork!, $address: String!, $eventType: String!, $limit: Int!, $offset: Int!, $from: ISO8601DateTime, $to: ISO8601DateTime, $txFrom: [String!]) {\n  ethereum(network: $network) {\n    smartContractEvents(\n      options: {limit: $limit, offset: $offset}\n      date: {since: $from, till: $to}\n      txFrom: {in: $txFrom}\n      smartContractAddress: {is: $address}\n      smartContractEvent: {is: $eventType}\n    ) {\n      count(smartContractEvent: {is: $eventType})\n      __typename\n    }\n    __typename\n  }\n}",variables:{network:this.network,address:this.dataAddress,eventType:this.eventType,offset:0,limit:1e4,from:null,to:null,txFrom:[this.walletAddress]}}}).then((function(e){return e.data.data.ethereum.smartContractEvents[0].count})).catch((function(t){return e.$Message.error("查詢戰鬥數據失敗，請過段時間再查詢"),console.error(t,"查詢戰鬥數據失敗，請過段時間再查詢"),-1}))},fetchGetFightData:function(){return r()({method:"post",url:this.api,headers:{"X-API-KEY":"BQYvhnv04csZHaprIBZNwtpRiDIwEIW9"},data:{query:'\n                    query ($network: EthereumNetwork!, $bnbHeroAddress: String!, $limit: Int!, $offset: Int!, $startDate: ISO8601DateTime, $endDate: ISO8601DateTime, $txFrom: [String!]) {\n                        ethereum(network: $network) {\n                            transactions(\n                            txSender: {in: $txFrom}\n                            txTo: {is: $bnbHeroAddress}\n                            options: {desc: "block.height", limit: $limit, offset: $offset}\n                            ) {\n                            block {\n                                height\n                                timestamp {\n                                unixtime\n                                }\n                            }\n                            gasValue\n                            success\n                            }\n                            smartContractEvents(\n                            options: {desc: "block.height", limit: $limit, offset: $offset}\n                            txFrom: {in: $txFrom}\n                            smartContractAddress: {is: $bnbHeroAddress}\n                            date: {since: $startDate, till: $endDate}\n                            ) {\n                            block {\n                                height\n                                timestamp {\n                                unixtime\n                                }\n                            }\n                            arguments {\n                                value\n                                argument\n                            }\n                            }\n                        }\n                        }\n                    ',variables:{network:this.network,bnbHeroAddress:this.dataAddress,offset:0,limit:1e5,startDate:null,endDate:null,txFrom:[this.walletAddress]}}}).then(this.handleFightData).catch((function(e){return console.error(e,"查詢戰鬥數據失敗"),[]}))},handleFightData:function(e){var t=this,n=e.data.data.ethereum,i=n.smartContractEvents,r=n.transactions;return b(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.handleTransactions(r),t.handleEventsData(i),Object(a.h)("walletAddress",t.walletAddress);case 3:case"end":return e.stop()}}),e,t)})))()},handleEventsData:function(e){var t=this;this.heroObj={};var n=e.map((function(e,n){var a=e.arguments,i=e.block,r={};a.forEach((function(e){var n=e.argument,a=e.value;return r[n]=function(e,n,a){switch(e){case"townType":return a.enemyType="Town "+n+" Level up",n;case"level":return!a.enemyType&&(a.enemyType="Unlocked Level "+n),n;case"_attackingHero":case"heroId":return a._heroId=n,t.heroObj[n]=!0,n;case"enemyType":return y.a[n].name;case"rewards":return n/1e18;default:return n}}(n,a,r)}));var s=d.a.unix(i.timestamp.unixtime);return r.timestamp=s.valueOf(),r.date=s.format("YYYY/MM/DD HH:mm:ss"),r.gasValue=t.successTrs[n].gasValue,r.enemyType||(r.enemyType="Others"),r}));this.data=n},handleTransactions:function(e){var t=this;this.successTrs=[],this.fairTrs=[],e.forEach((function(e){return e.success?t.successTrs.push(e):t.fairTrs.push(e)}))},handleChangeDate:function(e){var t=T(e,2),n=t[0],a=t[1];this.startDate=n,this.endDate=a.replace("00:00","23:59")}},computed:{tableData:function(){var e=this;if(this.filterHero||this.filterEnemyType||this.endDate||this.startDate){var t=this.data.filter((function(t){var n=t._heroId,a=void 0===n?"":n,i=t.enemyType;return(a.includes(e.filterHero)||!e.filterHero)&&(i.includes(e.filterEnemyType)||!e.filterEnemyType)}));if(this.endDate||this.startDate){var n=d()(this.startDate),a=d()(this.endDate);return t.filter((function(e){var t=e.timestamp;return n<=t&&t<=a}))}return t}return this.data},fairGasData:function(){if(this.endDate||this.startDate){var e=d()(this.startDate),t=d()(this.endDate);return this.fairTrs.filter((function(n){var a=n.block,i=d.a.unix(a.timestamp.unixtime);return e<=i&&i<=t}))}return this.fairTrs},fightCount:function(){return this.tableData.filter((function(e){return e.hpLoss})).length},fightSuccess:function(){return this.tableData.filter((function(e){return e.rewards})).length},fightFair:function(){return this.fightCount-this.fightSuccess},totalRewards:function(){return this.tableData.reduce((function(e,t){var n=t.rewards;return e+(void 0===n?0:n)}),0)},successGas:function(){return this.tableData.reduce((function(e,t){var n=t.gasValue;return e+(void 0===n?0:n)}),0)},fairGas:function(){return this.fairGasData.reduce((function(e,t){var n=t.gasValue;return e+(void 0===n?0:n)}),0)}}},g=(n(928),Object(o.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("Row",[n("Col",{attrs:{span:"4"}},[n("Input",{attrs:{placeholder:"bsc 錢包位址"},model:{value:e.walletAddress,callback:function(t){e.walletAddress=t},expression:"walletAddress"}})],1),e._v(" "),n("Col",{attrs:{span:"4"}},[n("Input",{attrs:{clearable:"",placeholder:"篩選英雄"},model:{value:e.filterHero,callback:function(t){e.filterHero=t},expression:"filterHero"}})],1),e._v(" "),n("Col",{attrs:{span:"4"}},[n("Input",{attrs:{clearable:"",placeholder:"篩選敵人"},model:{value:e.filterEnemyType,callback:function(t){e.filterEnemyType=t},expression:"filterEnemyType"}})],1),e._v(" "),n("Col",{attrs:{span:"8"}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange",format:"yyyy-MM-dd HH:mm",placeholder:"篩選日期"},on:{"on-change":e.handleChangeDate}})],1),e._v(" "),n("Col",{attrs:{span:"4"}},[n("Button",{attrs:{loading:e.isLoading,type:"success",long:"",icon:"ios-search"},on:{click:e.handleCalc}},[e._v("\n                    計算\n                ")])],1)],1),e._v(" "),e.tableData.length?n("Row",[n("Col",{staticClass:"info",attrs:{span:"24"}},[e._v("\n            總戰鬥次數: "+e._s(e.fightCount)+"\n            戰鬥成功: "+e._s(e.fightSuccess)+"\n            戰鬥失敗: "+e._s(e.fightFair)+"\n            實際勝率: "+e._s((e.fightSuccess/e.fightCount*100).toFixed(2))+"%\n        ")]),e._v(" "),n("Col",{staticClass:"info2",attrs:{span:"24"}},[e._v("\n            獎金(BNB): "+e._s(e.totalRewards.toFixed(4))+"\n            瓦斯費(BNB): "+e._s(e.successGas.toFixed(4))+"\n            失敗瓦斯費(BNB)(只篩選日期時間): "+e._s(e.fairGas.toFixed(4))+"\n        ")])],1):e._e(),e._v(" "),n("div",{staticClass:"flex"},e._l(e.columns,(function(t){return n("div",{key:t.key},[e._v(e._s(t.title))])})),0),e._v(" "),n("VirtualList",{staticStyle:{height:"calc(100vh - 258px)","overflow-y":"auto"},attrs:{"data-key":"date","data-sources":e.tableData,"data-component":e.item}})],1)}),[],!1,null,"5d9e87fc",null));t.default=g.exports}}]);
//# sourceMappingURL=FightData8a7125c4772e0b0491bf.js.map